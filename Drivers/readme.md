## 用語など
- `HAL`...Hardware Abstraction Layerで、ハードウェアを抽象化するためのレイヤ
- `MW`...Middleware でHALを扱うためのレイヤ
- `SY`...システム全般、各種仲介をするレイヤー
- `App`...応用レイヤー、ロボット個々のプログラムを定める。
- `DD`...デバイスドライバ、MDやSV,ABなどのデバイスを扱うためのレイヤ

### HALレイヤ
HALはハードウェアを抽象化する。このライブラリはメーカーから出されているもので、周辺機器例えばGPIO、UARTなどのモジュールを動かすためのレイヤ。これは直接は使わずに、MWに代わりに叩いてもらう。
```c
UART_HandleTypeDef huart1 = {
  .Instance = USART1,
  .Init = {
    .BaudRate = 115200,
    .WordLength = UART_WORDLENGTH_8B,
    .StopBits = UART_STOPBITS_1,
    .Parity = UART_PARITY_NONE,
    .Mode = UART_MODE_TX_RX,
    .HwFlowCtl = UART_HWCONTROL_NONE,
    .OverSampling = UART_OVERSAMPLING_16
  },
}; 
```
これが初期化の設定値の例である。これは仕様変更する可能性もあるため、アプリケーションや、デバイスドライバからは直接制御せず、後述するMWを介して行う。

MWはHALを扱うためのレイヤで、HALの定数など、一切触れずに簡単にハードウェアにアクセスするためのドライバ。各ペリフェラルごとに定義する。
たとえばUARTだったらこのようにする。
ドキュメントにそれぞれの関数の使い方を載せておくので参考にすると良い。

### MWレイヤ
MWはHALを抽象化する。これは木更津高専ロボット研究同好会独自の制作物である。それぞれのペリフェラルを扱うHALを抽象化したものである。新たな周辺機器を使う場合はここに書く。
- I2C
- ENCODER
- GPIO
- IWDG
- TIM
- UART
- flash
- message

などがある。FlashにはFlashProgrammingが含まれる。UARTにはUARTを扱うためのプログラムがある。messageにはPCへのメッセージ生成周りが含まれている。

### DDレイヤ
DDはハードウェアアクセスを抽象化する。具体的な通信部分を含む。新たにハードを追加する場合はここに書く。ペリフェラルを操作する場合はそのペリフェラル操作部分をMWレイヤに記述する。
- ENCODER
- Gene
- MD
- RC
- SV
Geneには全体の統合するためのコードを定義する。RCは例外的に定義される。これはSYにて直接制御ハンドルされる。

### SYレイヤ
SYにはシステムのタスク管理をするレイヤである。エントリーポイントがあり、各種初期化やタイミング管理、システムコールなどを行う。アプリケーションの呼び出しやデバイスの制御の呼び出しなども含む。

### その他のファイル
リンカスクリプト、スタートアップルーチンなどが含まれる。
